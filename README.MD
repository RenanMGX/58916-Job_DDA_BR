# Job DDA_BR Automation

Este repositÃ³rio contÃ©m uma automaÃ§Ã£o desenvolvida em Python para interagir com o sistema SAP, realizar operaÃ§Ãµes especÃ­ficas e gerar logs detalhados. A automaÃ§Ã£o foi projetada para ser executada de forma eficiente e segura, utilizando boas prÃ¡ticas de programaÃ§Ã£o e bibliotecas confiÃ¡veis.

## ğŸ“‹ Funcionalidades

1. **ExtraÃ§Ã£o de Dados do SAP**:
   - A automaÃ§Ã£o conecta-se ao sistema SAP e extrai informaÃ§Ãµes de empresas utilizando a transaÃ§Ã£o `/n ZFI006`.
   - Os dados extraÃ­dos sÃ£o salvos em um arquivo Excel no diretÃ³rio de downloads do usuÃ¡rio.

2. **Processamento de Empresas**:
   - ApÃ³s a extraÃ§Ã£o, a automaÃ§Ã£o processa cada empresa encontrada, utilizando a transaÃ§Ã£o `/n dda_br` no SAP.
   - O processamento inclui a configuraÃ§Ã£o de filtros de data e status para a execuÃ§Ã£o da transaÃ§Ã£o.

3. **GeraÃ§Ã£o de Logs**:
   - Logs detalhados sÃ£o gerados para cada etapa da execuÃ§Ã£o, incluindo erros e relatÃ³rios de progresso.
   - Os logs podem ser salvos localmente em arquivos CSV e enviados para um servidor remoto.

4. **ConfiguraÃ§Ã£o e Credenciais**:
   - O sistema utiliza um arquivo de configuraÃ§Ã£o (`config.init`) para armazenar parÃ¢metros padrÃ£o.
   - As credenciais do SAP sÃ£o gerenciadas de forma segura utilizando arquivos JSON criptografados.

## ğŸ› ï¸ Estrutura do Projeto

```plaintext
â”œâ”€â”€ [main.py](http://_vscodecontentref_/0)                     # Arquivo principal para execuÃ§Ã£o da automaÃ§Ã£o
â”œâ”€â”€ Entities/
â”‚   â”œâ”€â”€ [sap.py](http://_vscodecontentref_/1)                  # Classe SAP para manipulaÃ§Ã£o de transaÃ§Ãµes no SAP
â”‚   â”œâ”€â”€ dependencies/
â”‚   â”‚   â”œâ”€â”€ [arguments.py](http://_vscodecontentref_/2)        # Gerenciamento de argumentos de linha de comando
â”‚   â”‚   â”œâ”€â”€ [config.py](http://_vscodecontentref_/3)           # Gerenciamento de configuraÃ§Ãµes
â”‚   â”‚   â”œâ”€â”€ [credenciais.py](http://_vscodecontentref_/4)      # Gerenciamento de credenciais criptografadas
â”‚   â”‚   â”œâ”€â”€ [default_config.py](http://_vscodecontentref_/5)   # ConfiguraÃ§Ãµes padrÃ£o
â”‚   â”‚   â”œâ”€â”€ [functions.py](http://_vscodecontentref_/6)        # FunÃ§Ãµes utilitÃ¡rias
â”‚   â”‚   â”œâ”€â”€ [logs.py](http://_vscodecontentref_/7)             # GeraÃ§Ã£o e envio de logs
â”‚   â”‚   â”œâ”€â”€ [navegador_chrome.py](http://_vscodecontentref_/8) # Classe para manipulaÃ§Ã£o do navegador Chrome
â”‚   â”‚   â”œâ”€â”€ [project_name.py](http://_vscodecontentref_/9)     # Nome do projeto
â”‚   â”‚   â”œâ”€â”€ [sharepointfolder.py](http://_vscodecontentref_/10) # Gerenciamento de pastas no SharePoint
â”‚   â””â”€â”€ [__init__.py](http://_vscodecontentref_/11)             # InicializaÃ§Ã£o do mÃ³dulo Entities
â”œâ”€â”€ [requirements.txt](http://_vscodecontentref_/12)            # DependÃªncias do projeto
â”œâ”€â”€ [config.init](http://_vscodecontentref_/13)                 # Arquivo de configuraÃ§Ã£o gerado automaticamente
â”œâ”€â”€ Logs/                       # DiretÃ³rio para armazenamento de logs
â””â”€â”€ .gitignore                  # Arquivo para ignorar arquivos no Git 
```

## ğŸš€ Como Executar

**PrÃ©-requisitos:**
Python 3.10 ou superior
SAP GUI instalado e configurado
DependÃªncias listadas no arquivo requirements.txt
InstalaÃ§Ã£o

**Clone o repositÃ³rio:**
Instale as dependÃªncias:

**Configure o arquivo config.init:**
O arquivo serÃ¡ gerado automaticamente na primeira execuÃ§Ã£o.
Edite o arquivo para ajustar as configuraÃ§Ãµes padrÃ£o, como credenciais e parÃ¢metros de log.

**Adicione as credenciais no diretÃ³rio especificado:**
As credenciais devem ser salvas no formato JSON no diretÃ³rio "caminho".

**Para iniciar a automaÃ§Ã£o, execute o seguinte comando:**
Argumentos DisponÃ­veis
start: Inicia a execuÃ§Ã£o completa da automaÃ§Ã£o.

## ğŸ“š Detalhes TÃ©cnicos
main.py
O arquivo principal que orquestra a execuÃ§Ã£o da automaÃ§Ã£o. Ele utiliza a classe SAP para interagir com o sistema SAP e processar as empresas.

Entities/sap.py
ContÃ©m a classe SAP, que herda de SAPManipulation. Essa classe encapsula a lÃ³gica para conectar-se ao SAP, executar transaÃ§Ãµes e manipular sessÃµes.

Entities/dependencies

**Este diretÃ³rio contÃ©m mÃ³dulos auxiliares, incluindo:**
arguments.py: Gerencia argumentos de linha de comando.
config.py: Lida com configuraÃ§Ãµes do projeto.
credenciais.py: Gerencia credenciais criptografadas.
logs.py: Gera logs locais e remotos.
functions.py: FunÃ§Ãµes utilitÃ¡rias para manipulaÃ§Ã£o de arquivos e logs.

## ğŸ§ª Testes
Para testar a automaÃ§Ã£o, vocÃª pode usar o argumento start e verificar os logs gerados no diretÃ³rio Logs/.


Desenvolvido por: Renan Oliveira
Contato: renan.oliveira@patrimar.com.br